!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/bundles/relevaretargeting/",n(n.s="SwDr")}({"6Xru":function(e,t,n){},BQwF:function(e,t){var n=Shopware,a=n.Mixin,r=n.Application;a.register("releva-notification",{mixins:[a.getByName("notification")],methods:{handleNotifications:function(e){var t,n,a=r.getApplicationRoot();for(var i in e)"string"==typeof a.$t("releva-retargeting.messages."+e[i].code)?(t=a.$t("releva-retargeting.messages.fallback.title",{title:e[i].message}),n=a.$t("releva-retargeting.messages.fallback.message",{code:e[i].code,data:JSON.stringify(e[i].data)})):(t=a.$t("releva-retargeting.messages."+e[i].code+".title",e[i].data),n=a.$t("releva-retargeting.messages."+e[i].code+".message",e[i].data)),this.createNotification({title:t,message:n,variant:e[i].variant})},handleAjaxErrors:function(e){var t=this;if(e&&e.errors){var n=r.getApplicationRoot();e.errors.forEach((function(e){t.createNotification({title:n.$t("releva-retargeting.messages.ajax.title"),message:n.$t("releva-retargeting.messages.ajax.message",e),variant:"error"})}))}}}})},CT86:function(e,t,n){var a=n("G3jd");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("17b8e20c",a,!0,{})},EZlk:function(e,t){e.exports='{% block sw_text_field %}\n    {% block releva_config_check_api_button %}\n        <template v-if="salesChannel">\n            <sw-contextual-field v-bind="$attrs" :name="formFieldName">\n                <template #sw-field-input="{identification, error, disabled, size, setFocusClass, removeFocusClass }">\n                    <input\n                        :name="identification"\n                        :id="identification"\n                        :value="currentValue"\n                        :placeholder="placeholder"\n                        :disabled="disabled"\n                        @input="onInput"\n                        @change="onChange"\n                        @focus="setFocusClass"\n                        @blur="removeFocusClass">\n                </template>\n                <template #sw-contextual-field-suffix="{ disabled }">\n                    <span @click="changeMode(disabled)" class="releva-config-check-api-button-button">\n                        <span v-if="buttonText" class="releva-config-check-api-button-button-text">{{buttonText}}</span>\n                        <sw-icon v-if="buttonIcon" class="releva-config-check-api-button-button-icon" :color="buttonIcon.color" :name="buttonIcon.name" :small="true"></sw-icon>\n                    </span>\n                </template>\n            </sw-contextual-field>\n        </template>\n        <template v-else>\n            {{ scopeMessage }}\n        </template>\n    {% endblock %}\n{% endblock %}'},G3jd:function(e,t,n){},O1Uz:function(e){e.exports=JSON.parse('{"releva-retargeting":{"general":{"mainMenuItemGeneral":"releva.nz"},"config":{"relevanzApiKey":{"button":"API-Zugangsdaten testen"},"relevaSalesChannelSwitch":{"label":"Storefront-Verkaufskanal"}},"messages":{"1553935480":{"title":"Kann keine Verbindung zum releva.nz API-Server herstellen.","message":"salesChannel: {salesChannelName}, data: {data}"},"1553935569":{"title":"@:(releva-retargeting.messages.1553935786.title)","message":"@:(releva-retargeting.messages.1553935786.message)"},"1553935786":{"title":"Ihr API Key für releva.nz und Verkaufskanal \\"{salesChannelName}\\" ist fehlerhaft.","message":"<a href=\\"#/sw/plugin/settings/RelevaRetargeting\\">Konfiguriere Plugin hier.</a>"},"1579084006":{"title":"Es wurde kein Verkaufskanal für das releva.nz Plugin konfiguriert.","message":"Noch nicht registriert? <a href=\\"https://releva.nz\\" target=\\"blank\\">Jetzt nachholen.</a> Bereits registriert? <a href=\\"#/sw/plugin/settings/RelevaRetargeting\\">Konfiguriere Plugin hier.</a>"},"1579849966":{"title":"Verkaufskanal hat keine Domain.","message":"Verkaufskanal <a href=\\"#/sw/sales/channel/detail/{salesChannelId}\\">{salesChannelName}</a> benötigt eine Domain für den releva.nz Produktexport."},"ajax":{"title":"@:(releva-retargeting.general.mainMenuItemGeneral) hat einen Fehler verursacht","message":"{title}: {detail}"},"fallback":{"title":"{title}","message":"code: {code}, data: {data}"}}}}')},OOCV:function(e,t){e.exports='{% block sw_system_config_content_card_field %}\n    <template v-if="isDefaultSalesChannelOrGlobalScope(element)">\n        {% parent() %}\n    </template>\n    <template v-else>\n        <sw-inherit-wrapper v-model="actualConfigData[currentSalesChannelId][element.name]"\n                            v-bind="getInheritWrapperBind(element)"\n                            :hasParent="false"\n                            :inheritedValue="getInheritedValue(element)"\n                            :class="\'sw-system-config--field-\' + kebabCase(getElementBind(element).name)">\n            <template #content="props">\n                <sw-form-field-renderer v-bind="getElementBind(element, props)"\n                                        :disabled="props.isInherited"\n                                        :value="props.currentValue"\n                                        :key="props.isInheritField + props.isInherited"\n                                        @input="props.updateCurrentValue"\n                                        @change="props.updateCurrentValue">\n                </sw-form-field-renderer>\n            </template>\n        </sw-inherit-wrapper>\n    </template>\n{% endblock %}'},SZ7m:function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},r=0;r<t.length;r++){var i=t[r],s=i[0],l={id:e+":"+r,css:i[1],media:i[2],sourceMap:i[3]};a[s]?a[s].parts.push(l):n.push(a[s]={id:s,parts:[l]})}return n}n.r(t),n.d(t,"default",(function(){return p}));var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},s=r&&(document.head||document.getElementsByTagName("head")[0]),l=null,o=0,c=!1,u=function(){},f=null,g="data-vue-ssr-id",d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,n,r){c=n,f=r||{};var s=a(e,t);return h(s),function(t){for(var n=[],r=0;r<s.length;r++){var l=s[r];(o=i[l.id]).refs--,n.push(o)}t?h(s=a(e,t)):s=[];for(r=0;r<n.length;r++){var o;if(0===(o=n[r]).refs){for(var c=0;c<o.parts.length;c++)o.parts[c]();delete i[o.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],a=i[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(v(n.parts[r]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var s=[];for(r=0;r<n.parts.length;r++)s.push(v(n.parts[r]));i[n.id]={id:n.id,refs:1,parts:s}}}}function m(){var e=document.createElement("style");return e.type="text/css",s.appendChild(e),e}function v(e){var t,n,a=document.querySelector("style["+g+'~="'+e.id+'"]');if(a){if(c)return u;a.parentNode.removeChild(a)}if(d){var r=o++;a=l||(l=m()),t=S.bind(null,a,r,!1),n=S.bind(null,a,r,!0)}else a=m(),t=C.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function S(e,t,n,a){var r=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=y(t,r);else{var i=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function C(e,t){var n=t.css,a=t.media,r=t.sourceMap;if(a&&e.setAttribute("media",a),f.ssrId&&e.setAttribute(g,t.id),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},SwDr:function(e,t,n){"use strict";n.r(t);n("BQwF");var a=n("nKaH"),r=n.n(a),i=(n("sipW"),Shopware),s=i.Component,l=i.Mixin;s.register("releva-retargeting-statistic",{template:r.a,inject:["retargetingApiService"],mixins:[l.getByName("releva-notification")],metaInfo:function(){return{title:this.$createTitle()}},data:function(){return{currentIframeUrl:null,salesChannelsToIframeUrl:null}},created:function(){var e=this;this.retargetingApiService.getInvolvedSalesChannelsToIframeUrls().then((function(t){e.handleNotifications(t.notifications),e.salesChannelsToIframeUrl=t.data,e.onSalesChannelsToIframeUrlSelectionChange(e.salesChannelsToIframeUrl[0].iframeUrl)})).catch((function(t){var n=t.response.data;e.handleAjaxErrors(n)}))},methods:{onSalesChannelsToIframeUrlSelectionChange:function(e){this.currentIframeUrl=e}}});var o=n("EZlk"),c=n.n(o),u=(n("CT86"),Shopware),f=u.Component,g=u.Mixin;f.extend("releva-config-check-api-button","sw-text-field",{template:c.a,inheritAttrs:!1,mixins:[g.getByName("releva-notification")],inject:["retargetingApiService"],data:function(){return{checkApiState:"unchecked",buttonText:(e=this,t="releva-retargeting"+e.$attrs.name.substr(e.$attrs.name.indexOf("."))+".button",n=e.$tc(t),t!==n&&n),salesChannel:function(e){for(var t=e;void 0!==t.$parent;)if(void 0!==(t=t.$parent).currentSalesChannelId)return t.currentSalesChannelId;return""}(this),scopeMessage:this.$attrs.scopeMessage};var e,t,n},computed:{buttonIcon:function(){switch(this.checkApiState){case"success":return{name:"default-basic-checkmark-circle",color:"green"};case"error":return{name:"default-badge-error",color:"red"};case"checking":return{name:"default-web-loading-circle",color:"gray"};default:return{name:"default-action-cloud-upload",color:"silver"}}}},methods:{changeMode:function(e){var t=this;if(!e){this.checkApiState="checking";var n=this;this.retargetingApiService.getVerifyApiKey({apiKey:void 0!==this.currentValue?this.currentValue.trim():"",salesChannel:function(e){for(;void 0!==e.$parent;)if(void 0!==(e=e.$parent).currentSalesChannelId)return e.currentSalesChannelId;return""}(this)}).then((function(e){n.checkApiState=null===e.data.userId?"error":"success",t.handleNotifications(e.notifications)})).catch((function(e){var t=e.response.data;n.checkApiState="unchecked",n.handleAjaxErrors(t)}))}}}});var d=n("OOCV"),p=n.n(d);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var v=Shopware,b=v.Component,y=(v.Defaults,v.Mixin);v.State,Shopware.Data.Criteria;function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=x(e);if(t){var r=x(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return A(this,n)}}function A(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}b.override("sw-system-config",{template:p.a,inject:["retargetingApiService"],mixins:[y.getByName("releva-notification")],watch:{currentSalesChannelId:function(){this.readConfig()},config:function(){if("RelevaRetargeting.config"===this.domain){var e,t=h(this.config);try{for(t.s();!(e=t.n()).done;){var n,a=e.value,r=h(a.elements);try{for(r.s();!(n=r.n()).done;){var i=n.value;!this.currentSalesChannelId&&i.config.hasOwnProperty("scope")&&"global"!==i.config.scope?a.elements=a.elements.filter((function(e){return i!==e})):i.config.disabled=!!i.config.hasOwnProperty("disabled")&&i.config.disabled}}catch(e){r.e(e)}finally{r.f()}0===a.elements.length&&(this.config=this.config.filter((function(e){return a!==e})))}}catch(e){t.e(e)}finally{t.f()}}}},methods:{saveAll:function(){var e=this;return this.isLoading=!0,"RelevaRetargeting.config"===this.domain&&this.currentSalesChannelId?this.retargetingApiService.getVerifyApiKey({apiKey:this.actualConfigData[this.currentSalesChannelId]["RelevaRetargeting.config.relevanzApiKey"],salesChannel:this.currentSalesChannelId,save:!0}).then((function(t){return e.actualConfigData.hasOwnProperty(e.currentSalesChannelId)&&(e.actualConfigData[e.currentSalesChannelId]["RelevaRetargeting.config.relevanzUserId"]=t.data.userId),e.handleNotifications(t.notifications),e.$super("saveAll")})).catch((function(t){var n=t.response.data;return e.handleAjaxErrors(n),e.$super("saveAll")})).finally((function(){return e.isLoading=!1})):this.$super("saveAll")},isDefaultSalesChannelOrGlobalScope:function(e){return"RelevaRetargeting.config"!==this.domain||!(e.config.hasOwnProperty("scopeMessage")||e.config.hasOwnProperty("scope")&&"global"!==e.config.scope)}}});var O=Shopware.Classes.ApiService,P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(i,e);var t,n,a,r=k(i);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/releva/retargeting";return C(this,i),r.call(this,e,t,n)}return t=i,(n=[{key:"getInvolvedSalesChannelsToIframeUrls",value:function(e){var t="".concat(this.getApiBasePath(),"/getInvolvedSalesChannelsToIframeUrls");return this.httpClient.post(t,{config:e},{headers:this.getBasicHeaders()}).then((function(e){return O.handleResponse(e)}))}},{key:"getVerifyApiKey",value:function(e){var t="".concat(this.getApiBasePath(),"/getVerifyApiKey");return this.httpClient.post(t,{config:e},{headers:this.getBasicHeaders()}).then((function(e){return O.handleResponse(e)}))}}])&&w(t.prototype,n),a&&w(t,a),i}(O),_=Shopware.Application;_.addServiceProvider("retargetingApiService",(function(e){var t=_.getContainer("init");return new P(t.httpClient,e.loginService)}));var j=n("O1Uz"),N=n("Xwpa");Shopware.Module.register("releva-retargeting",{type:"plugin",name:"relevanz-retargeting",title:"releva-retargeting.general.mainMenuItemGeneral",favicon:"../../../../../relevaretargeting/administration/static/img/favicon/modules/icon-module-releva-retargeting.png",snippets:{"de-DE":j,"en-GB":N},routes:{statistic:{component:"releva-retargeting-statistic",path:"statistic"}},navigation:[{label:"releva-retargeting.general.mainMenuItemGeneral",path:"releva.retargeting.statistic",parent:"sw-marketing"}]})},Xwpa:function(e){e.exports=JSON.parse('{"releva-retargeting":{"general":{"mainMenuItemGeneral":"releva.nz"},"config":{"relevanzApiKey":{"button":"Check API-Access"},"relevaSalesChannelSwitch":{"label":"Storefront-sales-channel"}},"messages":{"1553935480":{"title":"Unable to connect to releva.nz API-Server.","message":"salesChannel: {salesChannelName}, data: {data}"},"1553935569":{"title":"@:(releva-retargeting.messages.1553935786.title)","message":"@:(releva-retargeting.messages.1553935786.message)"},"1553935786":{"title":"The API key for sales-channel \\"{salesChannelName}\\" cannot be verified. Please make sure that the API key is correct.","message":"<a href=\\"#/sw/plugin/settings/RelevaRetargeting\\">Configure plugin here.</a>"},"1579084006":{"title":"No sales-channels are configured for releva.nz plugin.","message":"Not yet registered? <a href=\\"https://releva.nz\\" target=\\"blank\\">Now catch up.</a> Already registered? <a href=\\"#/sw/plugin/settings/RelevaRetargeting\\">Configure plugin here.</a>"},"1579849966":{"title":"Sales-channel doesn\'t have domain.","message":"Sales-channel <a href=\\"#/sw/sales/channel/detail/{salesChannelId}\\">{salesChannelName}</a> need a domain for the releva.nz article export."},"ajax":{"title":"@:(releva-retargeting.general.mainMenuItemGeneral) produced a error","message":"{title}: {detail}"},"fallback":{"title":"{title}","message":"code: {code}, data: {data}"}}}}')},nKaH:function(e,t){e.exports='{% block releva_retargeting_statistic %}\n    <sw-page class="releva-retargeting-statistic">\n        <template slot="smart-bar-actions">\n            {% block releva_retargeting_statistic_actions %}\n                <sw-single-select\n                    v-if="salesChannelsToIframeUrl && salesChannelsToIframeUrl.length > 1"\n                    class="releva-frame-releva-sales-channel-switch"\n                    size="big" \n                    labelProperty="salesChannel"\n                    valueProperty="iframeUrl"\n                    @change="onSalesChannelsToIframeUrlSelectionChange"\n                    :value="currentIframeUrl"\n                    :options="salesChannelsToIframeUrl"\n                    :placeholder="$tc(\'releva-retargeting.config.relevaSalesChannelSwitch.label\')"\n                ></sw-single-select>\n            {% endblock %}\n        </template>\n        <template slot="content">\n            {% block releva_retargeting_statistic_content %}\n                <div v-if=\'currentIframeUrl\' class="releva-frame-container">\n                    <template>\n                        <iframe v-bind:src="currentIframeUrl" class="releva-frame-frame"></iframe>\n                    </template>\n                </div>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n'},sipW:function(e,t,n){var a=n("6Xru");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("45aea110",a,!0,{})}});