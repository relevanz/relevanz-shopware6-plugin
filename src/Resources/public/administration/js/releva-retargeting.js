!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=(window.__sw__.assetPath + '/bundles/relevaretargeting/'),n(n.s="AmJm")}({AmJm:function(e,t,n){"use strict";n.r(t);n("Z7HW"),n("Rt7f");var r=Shopware,a=r.Component,i=r.Mixin;a.register("releva-retargeting-statistic",{template:'{% block releva_retargeting_statistic %}\n    <sw-page class="releva-retargeting-statistic">\n        <template slot="smart-bar-actions">\n            {% block releva_retargeting_statistic_actions %}\n                <sw-single-select\n                    v-if="salesChannelsToIframeUrl && salesChannelsToIframeUrl.length > 1"\n                    class="releva-frame-releva-sales-channel-switch"\n                    size="big" \n                    labelProperty="salesChannel"\n                    valueProperty="iframeUrl"\n                    @change="onSalesChannelsToIframeUrlSelectionChange"\n                    :value="currentIframeUrl"\n                    :options="salesChannelsToIframeUrl"\n                    :placeholder="$tc(\'releva-retargeting.config.relevaSalesChannelSwitch.label\')"\n                ></sw-single-select>\n            {% endblock %}\n        </template>\n        <template slot="content">\n            {% block releva_retargeting_statistic_content %}\n                <div v-if=\'currentIframeUrl\' class="releva-frame-container">\n                    <template>\n                        <iframe v-bind:src="currentIframeUrl" class="releva-frame-frame"></iframe>\n                    </template>\n                </div>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n',inject:["retargetingApiService"],mixins:[i.getByName("releva-notification")],metaInfo:function(){return{title:this.$createTitle()}},data:function(){return{currentIframeUrl:null,salesChannelsToIframeUrl:null}},created:function(){var e=this;this.retargetingApiService.getInvolvedSalesChannelsToIframeUrls().then((function(t){e.handleNotifications(t.notifications),e.salesChannelsToIframeUrl=t.data,e.onSalesChannelsToIframeUrlSelectionChange(e.salesChannelsToIframeUrl[0].iframeUrl)})).catch((function(t){var n=t.response.data;e.handleAjaxErrors(n)}))},methods:{onSalesChannelsToIframeUrlSelectionChange:function(e){this.currentIframeUrl=e}}});n("QSu2");var o=Shopware,l=o.Component,s=o.Mixin;l.extend("releva-config-check-api-button","sw-text-field",{template:'{% block sw_text_field %}\n    {% block releva_config_check_api_button %}\n        <template v-if="salesChannel">\n            <sw-contextual-field v-bind="$attrs" :name="formFieldName">\n                <template #sw-field-input="{identification, error, disabled, size, setFocusClass, removeFocusClass }">\n                    <input\n                        :name="identification"\n                        :id="identification"\n                        :value="currentValue"\n                        :placeholder="placeholder"\n                        :disabled="disabled"\n                        @input="onInput"\n                        @change="onChange"\n                        @focus="setFocusClass"\n                        @blur="removeFocusClass">\n                </template>\n                <template #sw-contextual-field-suffix="{ disabled }">\n                    <span @click="changeMode(disabled)" class="releva-config-check-api-button-button">\n                        <span v-if="buttonText" class="releva-config-check-api-button-button-text">{{buttonText}}</span>\n                        <sw-icon v-if="buttonIcon" class="releva-config-check-api-button-button-icon" :color="buttonIcon.color" :name="buttonIcon.name" :small="true"></sw-icon>\n                    </span>\n                </template>\n            </sw-contextual-field>\n        </template>\n        <template v-else>\n            {{ scopeMessage }}\n        </template>\n    {% endblock %}\n{% endblock %}',inheritAttrs:!1,mixins:[s.getByName("releva-notification")],inject:["retargetingApiService"],data:function(){return{checkApiState:"unchecked",buttonText:(e=this,t="releva-retargeting"+e.$attrs.name.substr(e.$attrs.name.indexOf("."))+".button",n=e.$tc(t),t!==n&&n),salesChannel:function(e){for(var t=e;void 0!==t.$parent;)if(void 0!==(t=t.$parent).currentSalesChannelId)return t.currentSalesChannelId;return""}(this),scopeMessage:this.$attrs.scopeMessage};var e,t,n},computed:{buttonIcon:function(){switch(this.checkApiState){case"success":return{name:"default-basic-checkmark-circle",color:"green"};case"error":return{name:"default-badge-error",color:"red"};case"checking":return{name:"default-web-loading-circle",color:"gray"};default:return{name:"default-action-cloud-upload",color:"silver"}}}},methods:{changeMode:function(e){var t=this;if(!e){this.checkApiState="checking";var n=this;this.retargetingApiService.getVerifyApiKey({apiKey:void 0!==this.currentValue?this.currentValue.trim():"",salesChannel:function(e){for(;void 0!==e.$parent;)if(void 0!==(e=e.$parent).currentSalesChannelId)return e.currentSalesChannelId;return""}(this)}).then((function(e){n.checkApiState=null===e.data.userId?"error":"success",t.handleNotifications(e.notifications)})).catch((function(e){var t=e.response.data;n.checkApiState="unchecked",n.handleAjaxErrors(t)}))}}}});function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=Shopware,g=f.Component,d=(f.Defaults,f.Mixin);f.State,Shopware.Data.Criteria;function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,i=void 0,i=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===p(i)?i:String(i)),r)}var a,i}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var a=S(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}g.override("sw-system-config",{template:'{% block sw_system_config_content_card_field %}\n    <template v-if="isDefaultSalesChannelOrGlobalScope(element)">\n        {% parent() %}\n    </template>\n    <template v-else>\n        <sw-inherit-wrapper v-model="actualConfigData[currentSalesChannelId][element.name]"\n                            v-bind="getInheritWrapperBind(element)"\n                            :hasParent="false"\n                            :inheritedValue="getInheritedValue(element)"\n                            :class="\'sw-system-config--field-\' + kebabCase(getElementBind(element).name)">\n            <template #content="props">\n                <sw-form-field-renderer v-bind="getElementBind(element, props)"\n                                        :disabled="props.isInherited"\n                                        :value="props.currentValue"\n                                        :key="props.isInheritField + props.isInherited"\n                                        @input="props.updateCurrentValue"\n                                        @change="props.updateCurrentValue">\n                </sw-form-field-renderer>\n            </template>\n        </sw-inherit-wrapper>\n    </template>\n{% endblock %}',inject:["retargetingApiService"],mixins:[d.getByName("releva-notification")],watch:{currentSalesChannelId:function(){this.readConfig()},config:function(){if("RelevaRetargeting.config"===this.domain){var e,t=c(this.config);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,a=c(r.elements);try{for(a.s();!(n=a.n()).done;){var i=n.value;!this.currentSalesChannelId&&i.config.hasOwnProperty("scope")&&"global"!==i.config.scope?r.elements=r.elements.filter((function(e){return i!==e})):i.config.disabled=!!i.config.hasOwnProperty("disabled")&&i.config.disabled}}catch(e){a.e(e)}finally{a.f()}0===r.elements.length&&(this.config=this.config.filter((function(e){return r!==e})))}}catch(e){t.e(e)}finally{t.f()}}}},methods:{saveAll:function(){var e=this;return this.isLoading=!0,"RelevaRetargeting.config"===this.domain&&this.currentSalesChannelId?this.retargetingApiService.getVerifyApiKey({apiKey:this.actualConfigData[this.currentSalesChannelId]["RelevaRetargeting.config.relevanzApiKey"],salesChannel:this.currentSalesChannelId,save:!0}).then((function(t){return e.actualConfigData.hasOwnProperty(e.currentSalesChannelId)&&(e.actualConfigData[e.currentSalesChannelId]["RelevaRetargeting.config.relevanzUserId"]=t.data.userId),e.handleNotifications(t.notifications),e.$super("saveAll")})).catch((function(t){var n=t.response.data;return e.handleAjaxErrors(n),e.$super("saveAll")})).finally((function(){return e.isLoading=!1})):this.$super("saveAll")},isDefaultSalesChannelOrGlobalScope:function(e){return"RelevaRetargeting.config"!==this.domain||!(e.config.hasOwnProperty("scopeMessage")||e.config.hasOwnProperty("scope")&&"global"!==e.config.scope)}}});var C=Shopware.Classes.ApiService,w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(i,e);var t,n,r,a=b(i);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/releva/retargeting";return h(this,i),a.call(this,e,t,n)}return t=i,(n=[{key:"getInvolvedSalesChannelsToIframeUrls",value:function(e){var t="".concat(this.getApiBasePath(),"/getInvolvedSalesChannelsToIframeUrls");return this.httpClient.post(t,{config:e},{headers:this.getBasicHeaders()}).then((function(e){return C.handleResponse(e)}))}},{key:"getVerifyApiKey",value:function(e){var t="".concat(this.getApiBasePath(),"/getVerifyApiKey");return this.httpClient.post(t,{config:e},{headers:this.getBasicHeaders()}).then((function(e){return C.handleResponse(e)}))}}])&&v(t.prototype,n),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(C),I=Shopware.Application;I.addServiceProvider("retargetingApiService",(function(e){var t=I.getContainer("init");return new w(t.httpClient,e.loginService)}));var k=n("rK52"),A=n("lDRv");Shopware.Module.register("releva-retargeting",{type:"plugin",name:"relevanz-retargeting",title:"releva-retargeting.general.mainMenuItemGeneral",favicon:"../../../../../relevaretargeting/administration/static/img/favicon/modules/icon-module-releva-retargeting.png",snippets:{"de-DE":k,"en-GB":A},routes:{statistic:{component:"releva-retargeting-statistic",path:"statistic"}},navigation:[{label:"releva-retargeting.general.mainMenuItemGeneral",path:"releva.retargeting.statistic",parent:"sw-marketing"}]})},FxUG:function(e,t,n){},QKMk:function(e,t,n){},QSu2:function(e,t,n){var r=n("FxUG");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,n("ydqr").default)("0b9121c3",r,!0,{})},Rt7f:function(e,t,n){var r=n("QKMk");r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,n("ydqr").default)("e73689be",r,!0,{})},Z7HW:function(e,t){var n=Shopware,r=n.Mixin,a=n.Application;r.register("releva-notification",{mixins:[r.getByName("notification")],methods:{handleNotifications:function(e){var t,n,r=a.getApplicationRoot();for(var i in e)"string"==typeof r.$t("releva-retargeting.messages."+e[i].code)?(t=r.$t("releva-retargeting.messages.fallback.title",{title:e[i].message}),n=r.$t("releva-retargeting.messages.fallback.message",{code:e[i].code,data:JSON.stringify(e[i].data)})):(t=r.$t("releva-retargeting.messages."+e[i].code+".title",e[i].data),n=r.$t("releva-retargeting.messages."+e[i].code+".message",e[i].data)),this.createNotification({title:t,message:n,variant:e[i].variant})},handleAjaxErrors:function(e){var t=this;if(e&&e.errors){var n=a.getApplicationRoot();e.errors.forEach((function(e){t.createNotification({title:n.$t("releva-retargeting.messages.ajax.title"),message:n.$t("releva-retargeting.messages.ajax.message",e),variant:"error"})}))}}}})},lDRv:function(e){e.exports=JSON.parse('{"releva-retargeting":{"general":{"mainMenuItemGeneral":"releva.nz"},"config":{"relevanzApiKey":{"button":"Check API-Access"},"relevaSalesChannelSwitch":{"label":"Storefront-sales-channel"}},"messages":{"1553935480":{"title":"Unable to connect to releva.nz API-Server.","message":"salesChannel: {salesChannelName}, data: {data}"},"1553935569":{"title":"@:(releva-retargeting.messages.1553935786.title)","message":"@:(releva-retargeting.messages.1553935786.message)"},"1553935786":{"title":"The API key for sales-channel \\"{salesChannelName}\\" cannot be verified. Please make sure that the API key is correct.","message":"<a href=\\"#/sw/extension/config/RelevaRetargeting\\">Configure plugin here.</a>"},"1579084006":{"title":"No sales-channels are configured for releva.nz plugin.","message":"Not yet registered? <a href=\\"https://releva.nz\\" target=\\"blank\\">Now catch up.</a> Already registered? <a href=\\"#/sw/extension/config/RelevaRetargeting\\">Configure plugin here.</a>"},"1579849966":{"title":"Sales-channel doesn\'t have domain.","message":"Sales-channel <a href=\\"#/sw/sales/channel/detail/{salesChannelId}\\">{salesChannelName}</a> need a domain for the releva.nz article export."},"ajax":{"title":"@:(releva-retargeting.general.mainMenuItemGeneral) produced a error","message":"{title}: {detail}"},"fallback":{"title":"{title}","message":"code: {code}, data: {data}"}}}}')},rK52:function(e){e.exports=JSON.parse('{"releva-retargeting":{"general":{"mainMenuItemGeneral":"releva.nz"},"config":{"relevanzApiKey":{"button":"API-Zugangsdaten testen"},"relevaSalesChannelSwitch":{"label":"Storefront-Verkaufskanal"}},"messages":{"1553935480":{"title":"Kann keine Verbindung zum releva.nz API-Server herstellen.","message":"salesChannel: {salesChannelName}, data: {data}"},"1553935569":{"title":"@:(releva-retargeting.messages.1553935786.title)","message":"@:(releva-retargeting.messages.1553935786.message)"},"1553935786":{"title":"Ihr API Key für releva.nz und Verkaufskanal \\"{salesChannelName}\\" ist fehlerhaft.","message":"<a href=\\"#/sw/extension/config/RelevaRetargeting\\">Konfiguriere Plugin hier.</a>"},"1579084006":{"title":"Es wurde kein Verkaufskanal für das releva.nz Plugin konfiguriert.","message":"Noch nicht registriert? <a href=\\"https://releva.nz\\" target=\\"blank\\">Jetzt nachholen.</a> Bereits registriert? <a href=\\"#/sw/extension/config/RelevaRetargeting\\">Konfiguriere Plugin hier.</a>"},"1579849966":{"title":"Verkaufskanal hat keine Domain.","message":"Verkaufskanal <a href=\\"#/sw/sales/channel/detail/{salesChannelId}\\">{salesChannelName}</a> benötigt eine Domain für den releva.nz Produktexport."},"ajax":{"title":"@:(releva-retargeting.general.mainMenuItemGeneral) hat einen Fehler verursacht","message":"{title}: {detail}"},"fallback":{"title":"{title}","message":"code: {code}, data: {data}"}}}}')},ydqr:function(e,t,n){"use strict";function r(e,t){for(var n=[],r={},a=0;a<t.length;a++){var i=t[a],o=i[0],l={id:e+":"+a,css:i[1],media:i[2],sourceMap:i[3]};r[o]?r[o].parts.push(l):n.push(r[o]={id:o,parts:[l]})}return n}n.r(t),n.d(t,"default",(function(){return p}));var a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=a&&(document.head||document.getElementsByTagName("head")[0]),l=null,s=0,c=!1,u=function(){},f=null,g="data-vue-ssr-id",d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,n,a){c=n,f=a||{};var o=r(e,t);return h(o),function(t){for(var n=[],a=0;a<o.length;a++){var l=o[a];(s=i[l.id]).refs--,n.push(s)}t?h(o=r(e,t)):o=[];for(a=0;a<n.length;a++){var s;if(0===(s=n[a]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete i[s.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],r=i[n.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](n.parts[a]);for(;a<n.parts.length;a++)r.parts.push(m(n.parts[a]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var o=[];for(a=0;a<n.parts.length;a++)o.push(m(n.parts[a]));i[n.id]={id:n.id,refs:1,parts:o}}}}function v(){var e=document.createElement("style");return e.type="text/css",o.appendChild(e),e}function m(e){var t,n,r=document.querySelector("style["+g+'~="'+e.id+'"]');if(r){if(c)return u;r.parentNode.removeChild(r)}if(d){var a=s++;r=l||(l=v()),t=S.bind(null,r,a,!1),n=S.bind(null,r,a,!0)}else r=v(),t=C.bind(null,r),n=function(){r.parentNode.removeChild(r)};return t(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;t(e=r)}else n()}}var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function S(e,t,n,r){var a=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=y(t,a);else{var i=document.createTextNode(a),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function C(e,t){var n=t.css,r=t.media,a=t.sourceMap;if(r&&e.setAttribute("media",r),f.ssrId&&e.setAttribute(g,t.id),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}});